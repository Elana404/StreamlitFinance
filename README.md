# 股票期权估值工具

这是一个基于二叉树模型的股票期权估值工具，使用 Streamlit 构建。它旨在复刻一个基于 Excel VBA 的复杂估值模型，并提供一个现代、交互式的网页界面。

## 功能特性

- **双模式操作**:
  - **单个公司/批次估值**: 对单批期权进行详细分析，并提供参数敏感性图表。
  - **批量估值**: 通过可编辑的表格，高效地对多个不同的期权批次进行批量计算和对比。
- **灵活的参数设置**: 支持对影响期权价值的多种参数进行调整，包括市场数据、公司数据和期权条款。
- **动态图表分析**: 自动生成结果汇总表和对比分析图，使结果一目了然。
- **忠于原始模型**: 计算逻辑精确翻译自原始的 VBA 模型，确保结果的一致性。

## 如何运行

请按照以下步骤来设置并运行本项目。


### 1. 安装依赖

在激活虚拟环境后，使用 `pip` 和提供的 `requirements.txt` 文件来安装所有必需的 Python 库。

```bash
pip install -r requirements.txt
```

### 2. 启动应用

所有依赖安装完毕后，运行以下命令来启动 Streamlit 应用：

```bash
streamlit run my_app.py
```

命令执行后，您的默认浏览器会自动打开一个新的标签页，并加载出应用的界面。

## 如何使用

应用启动后，您可以按照以下方式使用：

1.  **选择计算模式**: 在左侧的侧边栏顶部，您可以选择 **"单个公司/批次估值"** 或 **"批量估值（从表格）"**。

2.  **单个公司/批次估值模式**:
    - 在侧边栏输入所有相关的全局市场参数和该批次期权自身的参数。
    - 点击 **"Calculate"** 按钮。
    - 主界面将显示计算出的单个期权价值、总价值以及期权价值对波动率的敏感性分析图。

3.  **批量估值（从表格）模式**:
    - 在侧边栏输入适用于所有批次的**全局参数**。
    - 在主界面的表格中，编辑每一列（代表一个批次）的特定参数。您可以直接修改、添加或删除列。
    - 点击 **"Calculate All Lots"** 按钮。
    - 主界面将显示包含所有批次计算结果的汇总表、所有批次的总价值以及不同批次价值的对比图表。 